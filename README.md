# A Novel Peak Detection System for Use with Microphysiological Systems which Mimic Human Nerve Fibers
An exploding topic in the scientific world currently is the microphysiological system (MPS) that offers a fast and cost-efficient alternative to traditional drug screening methods. Organoid-on-a-chip is a new technology that allows companies to structure 3D architectures that house biomimetic microversions of human body systems, ranging from heart cells in the cardiac system to tissue interfaces to complete human neurons. The last group is what research has been focused on at AxoSim Technologies located in New Orleans, LA.

### AxoSim's Nerve-on-a-Chip&trade;
AxoSim has developed a human nerve on a chip MPS using dual hydrogel systems which guide the neurite growth of a dorsal root ganglion tissue explant. The resulting neurons show distinct dendrite and neurite regions, which is amenable to clinical nerve compound action potential (CAP) and nerve fiber density (NFD) tests in vitro. These clinical tests, performed for the first time on a purely cellular <i>in vitro</i> model, are of great value for the study of acute and chronic exposure to drugs of interest. This is the first time that peripheral nerve patterns, like the CAP, have been observed in vitro, so the data generated from experiments involving the constructs is relatively new, although it shows resemblance to traditional action potentials. I was assigned to extract key parameters from the electrophysiological data.

### Electrophysiology and the CAP
The response of the human nerves growing within the patented constructs to clinical drugs was measured by conducting electrophysiological stimulation of the body and measuring how a compound action potential propagated along the grouped axons. Within each output file are 50 or more trace files, which display the waveforms as a result of 50 or more consecutive electrical stimulations. One such file, with time in milliseconds as the x-axis and amplified voltage in mV as the y-axis is found below:

<img src="/Presentation Images/intro image.png">

Evidently, there exists a lot of data in just one file. A single experiment can include dozens of files representing the nerve bundle's response to controls or different concentrations of drugs. The key parameters that we wished to extract, however, are the nerve conduction velocity (NCV) and amplitude of the aggregate waveform. The NCV is a measure of the latency of an electrical stimulation and is measured by noting how long it took for an electrical signal to trigger a compound action potential (found by considering the time of the first peak in the waveform) and dividing by the distance along the axon. 

### An accurate NCV predictor
I quickly set to work writing a series of script to help automate calculation of this first peak time in order to gather NCV. Because there are so many traces in each file, it previously had been a very subjective and slow process to decide on a timepoint at which this peak occurs; although I initially thought of simply representing the file as a mean trace of all its traces, the human calculation proved to be slightly more nuanced than that. Rather, it was necessary to consider each waveform and estimate a general trend of the first peaks in each one. By the end of my study, I was able to design a workflow from raw input file to NCV which generated results within 5% of a human's effort while drastically cutting the time required to analyze the multitude of data - effectively turning a day or two's amount of work into a <10-minute job.

Here are a few plots generated by the Seaborn library in Python to summarize my results and accuracy of prediction in different experiments (the human estimation was conducted by my mentor Dr. Hieu Nguyen):
<img src="/Presentation Images/PtxAllConc.png">
<img src="/Presentation Images/BzConc.png">
<img src="/Presentation Images/VnConc.png">
